<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="icon" type="image/png" href="favicon.ico">
  <link rel="stylesheet" type="text/css" href="/css/style.css">
  <script src="https://kit.fontawesome.com/6973571aae.js" crossorigin="anonymous"></script>
  <title>Dark-Matter7232</title>
<meta property="og:title" content="The Cosmic Staff Kernel For M31" />
      <meta property="og:description" content="The Cosmic Staff kernel for M31, for personal use." />
      <meta property="og:type" content="article" />
      <meta property="og:url" content="/posts/TheCosmicStaff-M31" />
      <meta property="og:image" content="https://dark-matter7232.github.io/cosmic.jpg" />

</head>

<h1 class="main-header">Const Coccinelle</h1>
<nav>
  <a href="/index"> <i class="fa-solid fa-user-astronaut"></i> Home</a>
  <a href="/about"> <i class="fa-solid fa-qrcode"></i> About</a>
  <!-- <a href="https://p.anuragcodes.me">Paste</a> -->
  <a href="/archive"> <i class="fa-solid fa-box-archive"></i> Archive</a>
  <a href="/uses"> <i class="fa-solid fa-microchip"></i> Uses</a>
</nav>

<article>
<h2 id="thecosmicstaff-kernel-for-m31">TheCosmicStaff Kernel For M31</h2>
<center>
<img src="https://raw.githubusercontent.com/Dark-Matter7232/Dark-Matter7232.github.io/v2/img/cosmic.jpg">
</center>
<h2 id="features">Features</h2>
<ul>
<li>Introduce Dynamic SchedTune Boost</li>
<li>Introduce SchedTuneAssist</li>
<li>Introduce CPUSetsAssist</li>
<li>ThinLTO</li>
<li>Sultan’s Simple Low Memory Killer</li>
<li>BBR Tcp congenstion algorithm</li>
<li>fq_codal network scheduler(qdisc)</li>
<li>Enable powerefficient workqueues OOTB</li>
<li>Add PowerSuspend Driver</li>
<li>Built with Dead code elimination enabled</li>
<li>Enabled BLK cgroup IO throttling</li>
<li>Silence unwanted logging</li>
<li>Enabled Gentle Fair Sleepers</li>
<li>Affine important userspace components to arm Big cores</li>
<li>Introduce Srandom</li>
<li>Sched imrpovements</li>
<li>UFS IO improvement</li>
<li>Grahpics Perf improvement</li>
<li>Power Efficiency improvement</li>
<li>Optimized Console FrameBuffer</li>
<li>100HZ timer</li>
<li>Boeffla Wakelock blocker</li>
<li>ARM64 targeted optimizations</li>
<li>IO_STAT disabled out of the box</li>
<li>Kill unwated google services</li>
<li>Disable Audit treewide</li>
<li>Make use of cacheline alignment</li>
<li>Make workqueue high priority</li>
<li>Tweak cpuidle governor for better battery life</li>
<li>3x faster integer sqrt</li>
<li>Enable Write Back Caching</li>
<li>Enable I/O throttling</li>
<li>disable crc checks (30% IO speed improvement)</li>
<li>set dirty ratio to 40%</li>
<li>add NEON accelerated XOR implementation</li>
</ul>
<h3 id="changelog">Changelog</h3>
<p>R1:</p>
<ul>
<li>Introduce SchedTune Assist (500% improvement in User experience at minimal cost of battery life)</li>
<li>Introduce Srandom (5 times faster than urandom)</li>
<li>Introduce Dynamic SchedTune Boost</li>
<li>Introduce CPUSetsAssist</li>
<li>Stub out debug prints by default (Graphics perf improvement)</li>
<li>Reserve caches for small, high-frequency memory allocations (Reduce latency)</li>
<li>Use power efficient workingqueues for drm (Battery life improvement)</li>
<li>Use power efficient workingqueues for block (Battery life improvement)</li>
<li>ThinLTO (perf improvement)</li>
<li>Introduce Sultan’s Simple Low Memory Killer</li>
<li>BBR Tcp congenstion algorithm</li>
<li>fq_codal network scheduler(qdisc)</li>
<li>Enable powerefficient workqueues OOTB</li>
<li>Add PowerSuspend Driver (almost eliminate idle battery drain)</li>
<li>Built with Dead code elimination enabled</li>
<li>Enabled BLK cgroup IO throttling</li>
<li>Silence unwanted logging</li>
<li>Enabled Gentle Fair Sleepers</li>
<li>Affine hwcomposer to big CPUs (lowered jitter)</li>
<li>Affine surfaceflinger to big CPUs (smoother ui experience)</li>
<li>Affine Wi-Fi components to big CPUs (lowered latency)</li>
<li>Affine ubound workqueues to little CPUs (lowered power consumption)</li>
<li>Perform PID map reads on the little CPU cluster (lowered power consumption)</li>
<li>Run nocb kthreads on little CPUs (lowered power consumptio)</li>
<li>Free dead tasks asynchronously in finish_task_switch() (reduce resource wastage)</li>
<li>Affine Samsung’s HyPer HAL to the big CPU cluster (quicker system boosting)</li>
<li>Hide magisk mounts for IsolatedService (Prevent magisk detection)</li>
<li>Updates to</li>
<li>Drop top-app level to 3</li>
<li>Improvements to boeffla Wakelock blocker</li>
<li>Add support for Gentle_fair_sleepers</li>
<li>Improvements to rcu</li>
<li>Improvements to zram module</li>
<li>Slightly faster booting</li>
<li>Add state notifier driver (works in conjuction with PowerSuspend)</li>
<li>Enable per-process reclaim</li>
<li>Upstream to 4.14.140</li>
<li>Disable Selinux auditing (lowered overhead)</li>
<li>Resolve sched_feat() at compile time to improve code optimization (Perf improvement)</li>
<li>Upstream to Linux 4.14.124</li>
<li>only force UX tasks to big cores (Power saving)</li>
<li>Disable UFS debugging (IO perf improvement)</li>
<li>Use SCHED_RR in place of SCHED_FIFO for all users (UX improvement)</li>
<li>Change default SCHED_RR timeslice from 100 ms to 1 jiffy (Lowered latency)</li>
<li>Make zsmalloc copy rather than mapping pages (Memory perf improvement)</li>
<li>Disable Selinux audit</li>
<li>Don’t dynamically allocate single-use structs (Reduce overhead)</li>
<li>Avoid dynamic memory allocation for small write buffers (Reduce overhead)</li>
<li>Avoid dynamically allocating memory in getxattr (Perf improvement)</li>
<li>Schedule workers on CPU0 or 0-5 by default (Power saving)</li>
<li>Fix memory leak for uncached firmware requests</li>
<li>Speed up cache entry creation (Reduce overhead)</li>
<li>Avoid dynamic allocations in sel_write_access (Perf improvement)</li>
<li>Avoid dynamic memory allocation for INITCONTEXTLEN buffers (Reduce overhead)</li>
<li>Use kmem_cache pool for struct dma_buf_attachment, dmabuf allocations, struct sync_file, sdcardfs_file_info, cgrp_cset_link, kernfs_open_node/file, async_entry (Reduce overhead)</li>
<li>Always compile core debugfs driver for Android kernels</li>
<li>Avoid allocating small buffers for map keys and values (Reduce overhead)</li>
<li>Start killing wakelocks after one minute of idle (Power saving)</li>
<li>Expedite garbage collection if idle (Power saving)</li>
<li>Add a timeout to wakelocks globally</li>
<li>Reduce QoS boosting from Samsung hacks (Power saving)</li>
<li>Disable full refcount validation (Perf improvement)</li>
<li>Micro-optimize PID map reads for arm64 while retaining output format (Help with games like genshin impact)</li>
<li>Stop kswapd early when nothing’s waiting for it to free pages</li>
<li>Don’t stop kswapd on a per-node basis when there are no waiters</li>
<li>Move frequently used functions to headers and declare them inline (Reduce overhead)</li>
<li>Don’t hog RCU read lock while optimistically spinning</li>
<li>Use interruptible wait for genirq, media v4l (Reduce latency)</li>
<li>Increase watermark scale factor</li>
<li>Update LZ4 components</li>
<li>Reduce latency while processing atomic ioctls (Reduce display rendering latency)</li>
</ul>
<hr>
<h3 id="flashing-intstrcutions">Flashing intstrcutions</h3>
<ul>
<li>Flash <code>Disable-userspace-slmk</code> module using magisk manager</li>
<li>Reboot to recovery</li>
<li>Flash the kernel</li>
<li>Enjoy</li>
</ul>
<h3 id="downlods">Downlods</h3>
<ul>
<li><strong>TheCosmicStaff-R1-M31</strong> - <a href="https://github.com/Dark-Matter7232/The-Cosmic-Staff/releases/download/R1-M31/CosmicStaff-ONEUI-R1-M31.zip">Download</a></li>
<li><strong>Disable-userspace-slmk</strong> - <a href="https://github.com/Dark-Matter7232/The-Cosmic-Staff/releases/download/R1-M31/Disable-userspace-slmk.zip">Download</a></li>
</ul>
<h3 id="sources">Sources</h3>
<ul>
<li><strong>Kernel source</strong> - <a href="https://github.com/Dark-Matter7232/The-Cosmic-Staff">Click here</a></li>
</ul>
<h4 id="note">Note</h4>
<p><strong>I built it for my personal use only, my goals were to achieve better efficiency and not performance</strong></p>
<hr>
<script src="https://utteranc.es/client.js"
        repo="Dark-Matter7232/Dark-Matter7232.github.io"
        issue-term="pathname"
        theme="github-dark-orange"
        crossorigin="anonymous"
        async>
</script>
</article>

<footer>
  <hr>
  <i class="far fa-copyright fa-fw"></i>2020-2022 Const | Made with ❤ in India</p>
</footer>
</body>
